<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/23/2026 12:00:00 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DESKTOP"
  DTS:CreatorName="DESKTOP\User"
  DTS:DTSID="{A1B2C3D4-E5F6-4789-A1B2-C3D4E5F67890}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.0.0"
  DTS:LocaleID="1033"
  DTS:ObjectName="LoadCustomerData"
  DTS:PackageType="5"
  DTS:VersionBuild="1"
  DTS:VersionGUID="{B2C3D4E5-F6A7-4891-B2C3-D4E5F6A78901}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{C3D4E5F6-A7B8-4912-C3D4-E5F6A7B89012}"
      DTS:ObjectName="ProcessName">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">CustomerETL</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Get Destination Table Name or File Name"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{D4E5F6A7-B8C9-4123-D4E5-F6A7B8C91234}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Get Destination Table Name or File Name"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E5F6A7B8-C9D1-4234-E5F6-A7B8C9D12345}"
          SQLTask:SqlStatementSource="DECLARE @TblNm NVARCHAR(255);&#xA;EXEC aud.spGetPackageDesTbl ?, @TblNm OUTPUT;&#xA;SELECT @TblNm AS DestinationTable;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::ProcessName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="255"/>
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Truncate Staging Table"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E6F7A8B9-C1D2-4345-E6F7-A8B9C1D23456}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Truncate Staging Table"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E5F6A7B8-C9D1-4234-E5F6-A7B8C9D12345}"
          SQLTask:SqlStatementSource="TRUNCATE TABLE staging.customers;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Load Customer Data"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F7A8B9C1-D2E3-4456-F7A8-B9C1D2E34567}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Load Customer Data"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E5F6A7B8-C9D1-4234-E5F6-A7B8C9D12345}"
          SQLTask:SqlStatementSource="INSERT INTO staging.customers (CustomerID, CustomerName, Email, Status, ProcessDate)&#xA;SELECT &#xA;    CustomerID,&#xA;    CustomerName,&#xA;    Email,&#xA;    Status,&#xA;    GETDATE() AS ProcessDate&#xA;FROM source.customers&#xA;WHERE Status = 'Active';" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update Control Table"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F6A7B8C9-D1E2-4345-F6A7-B8C9D1E23456}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update Control Table"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E5F6A7B8-C9D1-4234-E5F6-A7B8C9D12345}"
          SQLTask:SqlStatementSource="INSERT INTO control.load_log (process_name, rows_processed, process_date)&#xA;SELECT &#xA;    ? AS process_name,&#xA;    COUNT(*) AS rows_processed,&#xA;    GETDATE() AS process_date&#xA;FROM dw.customers&#xA;WHERE ProcessDate &gt;= CAST(GETDATE() AS DATE);" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::ProcessName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="255"/>
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{A7B8C9D1-E2F3-4456-A7B8-C9D1E2F34567}"
      DTS:From="Package\Get Destination Table Name or File Name"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Truncate Staging Table"
      DTS:Value="0"/>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{B8C9D1E2-F3A4-4567-B8C9-D1E2F3A45678}"
      DTS:From="Package\Truncate Staging Table"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Load Customer Data"
      DTS:Value="0"/>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{C9D1E2F3-A4B5-4678-C9D1-E2F3A4B56789}"
      DTS:From="Package\Load Customer Data"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Update Control Table"
      DTS:Value="0"/>
  </DTS:PrecedenceConstraints>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[SourceDB]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{E5F6A7B8-C9D1-4234-E5F6-A7B8C9D12345}"
      DTS:ObjectName="SourceDB">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=localhost;Initial Catalog=SourceDB;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<Objects Version="8">
  <Package design-time-name="Package">
    <LayoutInfo>
      <GraphLayout Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout Size="262,42" Id="Package\Get Destination Table Name or File Name" TopLeft="100,50" />
        <NodeLayout Size="198,42" Id="Package\Truncate Staging Table" TopLeft="132,130" />
        <NodeLayout Size="178,42" Id="Package\Load Customer Data" TopLeft="142,210" />
        <NodeLayout Size="198,42" Id="Package\Update Control Table" TopLeft="132,290" />
        <EdgeLayout Id="Package.PrecedenceConstraints[Constraint]" TopLeft="231,92">
          <EdgeLayout.Curve>
            <mssgle:Curve StartConnector="{assembly:Null}" EndConnector="0,38" Start="0,0" End="0,30.5" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" />
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout Id="Package.PrecedenceConstraints[Constraint 1]" TopLeft="231,172">
          <EdgeLayout.Curve>
            <mssgle:Curve StartConnector="{assembly:Null}" EndConnector="0,38" Start="0,0" End="0,30.5" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" />
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout Id="Package.PrecedenceConstraints[Constraint 2]" TopLeft="231,252">
          <EdgeLayout.Curve>
            <mssgle:Curve StartConnector="{assembly:Null}" EndConnector="0,38" Start="0,0" End="0,30.5" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" />
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>
